"use strict";function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_createClass=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),LoginForm=function(){function e(r){_classCallCheck(this,e),this.formCurrent=document.forms[r]}return _createClass(e,[{key:"getData",value:function(){var e={};if(void 0!==this.formCurrent)for(var r=this.formCurrent.elements.length,t=0;t<r;t++){var n=this.formCurrent.elements[t];"INPUT"===n.nodeName.toUpperCase()&&(e[n.name]=$.trim(n.value))}return e}},{key:"setData",value:function(e){var r=["fio","email","phone"];if(void 0!==this.formCurrent&&"object"===(void 0===e?"undefined":_typeof(e))&&!$.isEmptyObject(e)){var t=new Set(r);for(var n in e)e.hasOwnProperty(n)&&t.has(n)&&(this.formCurrent.elements[n].value=e[n])}}},{key:"validate",value:function(){var e=this;if(void 0!==this.formCurrent){var r=function(e,r){$("#"+e.id).addClass("error").after('<span class="pure-form-message-inline text-error">'+r+"</span>"),t=!1,n.push(e.name)},t=!0,n=[];return function(){var r="#"+e.formCurrent.id;$(r).find(".text-error ").remove(),$(r).find(".error").removeClass("error")}(),function(){var t=e.formCurrent.elements.fio;t.value?3===$.trim(t.value).split(" ").length?/^[А-яёЁ ]+$/i.test(t.value)||r(t,"В ФИО допускаются только русские буквы!"):r(t,"ФИО должно быть ровно 3 слова!"):r(t,"Это поле должно быть заполенно!")}(),function(){var t=e.formCurrent.elements.email;t.value?/^([\w\._]+)@(ya.ru|yandex.ru|yandex.ua|yandex.by|yandex.kz|yandex.com)$/i.test(t.value)||r(t,"Email должен быть из домена Яндекса!"):r(t,"Это поле должно быть заполенно!")}(),function(){var t=e.formCurrent.elements.phone;t.value?/^\+7\(\d{3}\)\d{3}-\d{2}-\d{2}$/i.test(t.value)?t.value.match(/\d/g).reduce(function(e,r){return e+ +r},0)>30&&r(t,"Сумма цифр телефона превышает 30"):r(t,"Формат телефона +7(XXX)XXX-XX-XX!"):r(t,"Это поле должно быть заполенно!")}(),{isValid:t,errorFields:n}}}},{key:"submit",value:function(){var e=this,r=function(e,r){$("#resultContainer").removeClass().addClass("alert alert-"+e).text(r).fadeIn(1e3).delay(2e3).fadeOut(1e3)},t=function(e){var t="",n="";switch(e.status){case"success":n="success",t="Данные успешно отправлены!";break;case"error":n="error",t=e.reason;break;case"progress":n="progress",t="Данные обрабатываются. Повтор через "+e.timeout+" секунд!";break;default:n="error",t="Ошибка структуры данных! Обратитесь к системному администратору!"}r(n,t)};if(void 0!==this.formCurrent){var n=7;this.validate().isValid&&($("#submitButton").addClass("pure-button-disabled"),function o(a){var s=["error.json","progress.json","success.json"],i=$("#"+e.formCurrent.id),u=i.attr("action")+s[Math.floor(Math.random()*s.length)];return $.ajax({url:u,type:"get",dataType:"json",data:i.serialize()}).done(function(e){t(e),"progress"===e.status?++a<=n&&setTimeout(function(){return o(a)},1e3*parseInt(e.timeout)):$("#submitButton").removeClass("pure-button-disabled")}).fail(function(){r("error","Ошибка получения данных!"),$("#submitButton").removeClass("pure-button-disabled")})}(1))}}}]),e}();$(function(){$("#resultContainer").hide(),window.MyForm=new LoginForm("form-valid");var e={fio:"Петров Иван Васильевич",email:"petr@ya.ru",phone:"+7(111)222-33-11",qwe:"111"};MyForm.setData(e),$("#submitButton").click(function(e){e.preventDefault(),MyForm.submit()})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbIkxvZ2luRm9ybSIsImZvcm1OYW1lIiwiX2NsYXNzQ2FsbENoZWNrIiwidGhpcyIsImZvcm1DdXJyZW50IiwiZG9jdW1lbnQiLCJmb3JtcyIsImZvcm1EYXRhIiwiY291bnRGb3JtRWxlbWVudHMiLCJlbGVtZW50cyIsImxlbmd0aCIsImkiLCJlbGVtZW50Q3VycmVudCIsIm5vZGVOYW1lIiwidG9VcHBlckNhc2UiLCJuYW1lIiwiJCIsInRyaW0iLCJ2YWx1ZSIsImluaXREYXRhIiwiZmllbGRzQ2hlY2siLCJfdHlwZW9mIiwiaXNFbXB0eU9iamVjdCIsInNldERhdGEiLCJTZXQiLCJrZXlEYXRhIiwiaGFzT3duUHJvcGVydHkiLCJoYXMiLCJfdGhpcyIsIlNob3dFcnJvciIsImNvbnRhaW5lciIsImVycm9yTWVzc2FnZSIsImlkIiwiYWRkQ2xhc3MiLCJhZnRlciIsImlzVmFsaWQiLCJlcnJvckZpZWxkcyIsInB1c2giLCJpZEZvcm0iLCJmaW5kIiwicmVtb3ZlIiwicmVtb3ZlQ2xhc3MiLCJyZXNldEVycm9yIiwiZmlvIiwic3BsaXQiLCJ0ZXN0IiwiZmlvQ2hlY2siLCJlbWFpbCIsImVtYWlsQ2hlY2siLCJwaG9uZSIsIm1hdGNoIiwicmVkdWNlIiwic3VtIiwiY3VycmVudCIsInBob25lQ2hlY2siLCJfdGhpczIiLCJzaG93TWVzc2FnZSIsInR5cGVNZXNzYWdlIiwidGV4dE1lc3NhZ2UiLCJ0ZXh0IiwiZmFkZUluIiwiZGVsYXkiLCJmYWRlT3V0Iiwic3dpdGNoTWVzc2FnZSIsImRhdGEiLCJzdGF0dXNNc2ciLCJkYXRhU3RhdHVzIiwic3RhdHVzIiwicmVhc29uIiwidGltZW91dCIsIm1heENvdW50IiwidmFsaWRhdGUiLCJnZXRTZXJ2aWNlIiwiY291bnQiLCJqc29uRmlsZW5hbWUiLCJhY3Rpb25VcmwiLCJhdHRyIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwiYWpheCIsInVybCIsInR5cGUiLCJkYXRhVHlwZSIsInNlcmlhbGl6ZSIsImRvbmUiLCJzZXRUaW1lb3V0IiwicGFyc2VJbnQiLCJmYWlsIiwiaGlkZSIsIndpbmRvdyIsIk15Rm9ybSIsImluaXRPYmoiLCJxd2UiLCJjbGljayIsImUiLCJwcmV2ZW50RGVmYXVsdCIsInN1Ym1pdCJdLCJtYXBwaW5ncyI6IitrQkFBTUEscUJBQ0YsU0FBQUEsRUFBWUMsR0FBVUMsZ0JBQUFDLEtBQUFILEdBQ2xCRyxLQUFLQyxZQUFjQyxTQUFTQyxNQUFNTCwwREFJbEMsSUFBSU0sS0FDSixRQUFnQyxJQUFyQkosS0FBS0MsWUFHWixJQUFLLElBRkNJLEVBQW9CTCxLQUFLQyxZQUFZSyxTQUFTQyxPQUUzQ0MsRUFBSSxFQUFHQSxFQUFJSCxFQUFtQkcsSUFBSyxDQUN4QyxJQUFJQyxFQUFpQlQsS0FBS0MsWUFBWUssU0FBU0UsR0FDRCxVQUExQ0MsRUFBZUMsU0FBU0MsZ0JBQ3hCUCxFQUFTSyxFQUFlRyxNQUFRQyxFQUFFQyxLQUFLTCxFQUFlTSxRQUlsRSxPQUFPWCxrQ0FHSFksR0FDSixJQUFNQyxHQUFlLE1BQU8sUUFBUyxTQUVyQyxRQUFnQyxJQUFyQmpCLEtBQUtDLGFBSVEsaUJBQXBCLElBQU9lLEVBQVAsWUFBQUUsUUFBT0YsTUFBMEJILEVBQUVNLGNBQWNILEdBQVcsQ0FDNUQsSUFBSUksRUFBVSxJQUFJQyxJQUFJSixHQUN0QixJQUFLLElBQUlLLEtBQVdOLEVBQ1hBLEVBQVNPLGVBQWVELElBR3pCRixFQUFRSSxJQUFJRixLQUNadEIsS0FBS0MsWUFBWUssU0FBU2dCLEdBQVNQLE1BQVFDLEVBQVNNLHdDQU16RCxJQUFBRyxFQUFBekIsS0FDUCxRQUFnQyxJQUFyQkEsS0FBS0MsWUFBaEIsQ0FJQSxJQUFJeUIsRUFBWSxTQUFDQyxFQUFXQyxHQUN4QmYsRUFBRSxJQUFNYyxFQUFVRSxJQUFJQyxTQUFTLFNBQVNDLE1BQXhDLHFEQUFtR0gsRUFBbkcsV0FDQUksR0FBVSxFQUNWQyxFQUFZQyxLQUFLUCxFQUFVZixPQTZEM0JvQixHQUFVLEVBQ1ZDLEtB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LGlCQUFpQjhFLE1BQU0sU0FBQ0MsR0FDdEJBLEVBQUVDLGlCQUNGTCxPQUFPTSIsImZpbGUiOiJpbmRleC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJjbGFzcyBMb2dpbkZvcm0ge1xyXG4gICAgY29uc3RydWN0b3IoZm9ybU5hbWUpIHtcclxuICAgICAgICB0aGlzLmZvcm1DdXJyZW50ID0gZG9jdW1lbnQuZm9ybXNbZm9ybU5hbWVdO1xyXG4gICAgfVxyXG5cclxuICAgIGdldERhdGEoKSB7XHJcbiAgICAgICAgbGV0IGZvcm1EYXRhID0ge307XHJcbiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLmZvcm1DdXJyZW50ICE9PSBcInVuZGVmaW5lZFwiKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvdW50Rm9ybUVsZW1lbnRzID0gdGhpcy5mb3JtQ3VycmVudC5lbGVtZW50cy5sZW5ndGg7XHJcblxyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNvdW50Rm9ybUVsZW1lbnRzOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGxldCBlbGVtZW50Q3VycmVudCA9IHRoaXMuZm9ybUN1cnJlbnQuZWxlbWVudHNbaV07XHJcbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudEN1cnJlbnQubm9kZU5hbWUudG9VcHBlckNhc2UoKSA9PT0gJ0lOUFVUJykge1xyXG4gICAgICAgICAgICAgICAgICAgIGZvcm1EYXRhW2VsZW1lbnRDdXJyZW50Lm5hbWVdID0gJC50cmltKGVsZW1lbnRDdXJyZW50LnZhbHVlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZm9ybURhdGE7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0RGF0YShpbml0RGF0YSkge1xyXG4gICAgICAgIGNvbnN0IGZpZWxkc0NoZWNrID0gW1wiZmlvXCIsIFwiZW1haWxcIiwgXCJwaG9uZVwiXTtcclxuXHJcbiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLmZvcm1DdXJyZW50ID09PSBcInVuZGVmaW5lZFwiKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0eXBlb2YgaW5pdERhdGEgPT09IFwib2JqZWN0XCIgJiYgISQuaXNFbXB0eU9iamVjdChpbml0RGF0YSkpIHtcclxuICAgICAgICAgICAgbGV0IHNldERhdGEgPSBuZXcgU2V0KGZpZWxkc0NoZWNrKTtcclxuICAgICAgICAgICAgZm9yIChsZXQga2V5RGF0YSBpbiBpbml0RGF0YSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFpbml0RGF0YS5oYXNPd25Qcm9wZXJ0eShrZXlEYXRhKSlcclxuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoc2V0RGF0YS5oYXMoa2V5RGF0YSkpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmZvcm1DdXJyZW50LmVsZW1lbnRzW2tleURhdGFdLnZhbHVlID0gaW5pdERhdGFba2V5RGF0YV07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgdmFsaWRhdGUoKSB7XHJcbiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLmZvcm1DdXJyZW50ID09PSBcInVuZGVmaW5lZFwiKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBTaG93RXJyb3IgPSAoY29udGFpbmVyLCBlcnJvck1lc3NhZ2UpID0+IHtcclxuICAgICAgICAgICAgJChcIiNcIiArIGNvbnRhaW5lci5pZCkuYWRkQ2xhc3MoJ2Vycm9yJykuYWZ0ZXIoYDxzcGFuIGNsYXNzPVwicHVyZS1mb3JtLW1lc3NhZ2UtaW5saW5lIHRleHQtZXJyb3JcIj4ke2Vycm9yTWVzc2FnZX08L3NwYW4+YCk7XHJcbiAgICAgICAgICAgIGlzVmFsaWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgZXJyb3JGaWVsZHMucHVzaChjb250YWluZXIubmFtZSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgbGV0IHJlc2V0RXJyb3IgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGlkRm9ybSA9IFwiI1wiICsgdGhpcy5mb3JtQ3VycmVudC5pZDtcclxuICAgICAgICAgICAgJChpZEZvcm0pLmZpbmQoXCIudGV4dC1lcnJvciBcIikucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgICQoaWRGb3JtKS5maW5kKFwiLmVycm9yXCIpLnJlbW92ZUNsYXNzKFwiZXJyb3JcIik7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgbGV0IGZpb0NoZWNrID0gKCkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgZmlvID0gdGhpcy5mb3JtQ3VycmVudC5lbGVtZW50cy5maW87XHJcbiAgICAgICAgICAgIGlmICghZmlvLnZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICBTaG93RXJyb3IoZmlvLCAn0K3RgtC+INC/0L7Qu9C1INC00L7Qu9C20L3QviDQsdGL0YLRjCDQt9Cw0L/QvtC70LXQvdC90L4hJyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICgkLnRyaW0oZmlvLnZhbHVlKS5zcGxpdChcIiBcIikubGVuZ3RoICE9PSAzKSB7XHJcbiAgICAgICAgICAgICAgICBTaG93RXJyb3IoZmlvLCAn0KTQmNCeINC00L7Qu9C20L3QviDQsdGL0YLRjCDRgNC+0LLQvdC+IDMg0YHQu9C+0LLQsCEnKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgbGV0IGFscGhhUmVnZXggPSAvXlvQkC3Rj9GR0IEgXSskL2k7XHJcbiAgICAgICAgICAgIGlmICghYWxwaGFSZWdleC50ZXN0KGZpby52YWx1ZSkpIHtcclxuICAgICAgICAgICAgICAgIFNob3dFcnJvcihmaW8sICfQkiDQpNCY0J4g0LTQvtC/0YPRgdC60LDRjtGC0YHRjyDRgtC+0LvRjNC60L4g0YDRg9GB0YHQutC40LUg0LHRg9C60LLRiyEnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGxldCBlbWFpbENoZWNrID0gKCkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgZW1haWwgPSB0aGlzLmZvcm1DdXJyZW50LmVsZW1lbnRzLmVtYWlsO1xyXG4gICAgICAgICAgICBpZiAoIWVtYWlsLnZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICBTaG93RXJyb3IoZW1haWwsICfQrdGC0L4g0L/QvtC70LUg0LTQvtC70LbQvdC+INCx0YvRgtGMINC30LDQv9C+0LvQtdC90L3QviEnKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBsZXQgZW1haWxSZWdleCA9IC9eKFtcXHdcXC5fXSspQCh5YS5ydXx5YW5kZXgucnV8eWFuZGV4LnVhfHlhbmRleC5ieXx5YW5kZXgua3p8eWFuZGV4LmNvbSkkL2k7XHJcbiAgICAgICAgICAgIGlmICghZW1haWxSZWdleC50ZXN0KGVtYWlsLnZhbHVlKSkge1xyXG4gICAgICAgICAgICAgICAgU2hvd0Vycm9yKGVtYWlsLCAnRW1haWwg0LTQvtC70LbQtdC9INCx0YvRgtGMINC40Lcg0LTQvtC80LXQvdCwINCv0L3QtNC10LrRgdCwIScpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgbGV0IHBob25lQ2hlY2sgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1heFN1bSA9IDMwO1xyXG5cclxuICAgICAgICAgICAgbGV0IHBob25lID0gdGhpcy5mb3JtQ3VycmVudC5lbGVtZW50cy5waG9uZTtcclxuICAgICAgICAgICAgaWYgKCFwaG9uZS52YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgU2hvd0Vycm9yKHBob25lLCAn0K3RgtC+INC/0L7Qu9C1INC00L7Qu9C20L3QviDQsdGL0YLRjCDQt9Cw0L/QvtC70LXQvdC90L4hJyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGxldCBwaG9uZVJlZ2V4ID0gL15cXCs3XFwoXFxkezN9XFwpXFxkezN9LVxcZHsyfS1cXGR7Mn0kL2k7XHJcbiAgICAgICAgICAgIGlmICghcGhvbmVSZWdleC50ZXN0KHBob25lLnZhbHVlKSkge1xyXG4gICAgICAgICAgICAgICAgU2hvd0Vycm9yKHBob25lLCAn0KTQvtGA0LzQsNGCINGC0LXQu9C10YTQvtC90LAgKzcoWFhYKVhYWC1YWC1YWCEnKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgbGV0IHJlc3VsdFN1bSA9IHBob25lLnZhbHVlLm1hdGNoKC9cXGQvZykucmVkdWNlKChzdW0sIGN1cnJlbnQpID0+IHN1bSArICtjdXJyZW50LCAwKTtcclxuICAgICAgICAgICAgaWYgKHJlc3VsdFN1bSA+IG1heFN1bSkge1xyXG4gICAgICAgICAgICAgICAgU2hvd0Vycm9yKHBob25lLCBg0KHRg9C80LzQsCDRhtC40YTRgCDRgtC10LvQtdGE0L7QvdCwINC/0YDQtdCy0YvRiNCw0LXRgiAke21heFN1bX1gKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBsZXQgaXNWYWxpZCA9IHRydWU7XHJcbiAgICAgICAgbGV0IGVycm9yRmllbGRzID0gW107XHJcblxyXG4gICAgICAgIHJlc2V0RXJyb3IoKTtcclxuXHJcbiAgICAgICAgZmlvQ2hlY2soKTtcclxuICAgICAgICBlbWFpbENoZWNrKCk7XHJcbiAgICAgICAgcGhvbmVDaGVjaygpO1xyXG5cclxuICAgICAgICByZXR1cm4ge2lzVmFsaWQsIGVycm9yRmllbGRzfVxyXG4gICAgfVxyXG5cclxuICAgIHN1Ym1pdCgpIHtcclxuICAgICAgICBsZXQgc2hvd01lc3NhZ2UgPSAodHlwZU1lc3NhZ2UsIHRleHRNZXNzYWdlKSA9PiB7XHJcbiAgICAgICAgICAgICQoJyNyZXN1bHRDb250YWluZXInKS5yZW1vdmVDbGFzcygpLmFkZENsYXNzKCdhbGVydCBhbGVydC0nICsgdHlwZU1lc3NhZ2UpLnRleHQodGV4dE1lc3NhZ2UpLmZhZGVJbigxMDAwKS5kZWxheSgyMDAwKS5mYWRlT3V0KDEwMDApO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGxldCBzd2l0Y2hNZXNzYWdlID0gKGRhdGEpID0+IHtcclxuICAgICAgICAgICAgbGV0IHN0YXR1c01zZyA9ICcnO1xyXG4gICAgICAgICAgICBsZXQgZGF0YVN0YXR1cyA9ICcnO1xyXG5cclxuICAgICAgICAgICAgc3dpdGNoIChkYXRhLnN0YXR1cykge1xyXG4gICAgICAgICAgICAgICAgY2FzZSBcInN1Y2Nlc3NcIjpcclxuICAgICAgICAgICAgICAgICAgICBkYXRhU3RhdHVzID0gXCJzdWNjZXNzXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzTXNnID0gXCLQlNCw0L3QvdGL0LUg0YPRgdC/0LXRiNC90L4g0L7RgtC/0YDQsNCy0LvQtdC90YshXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIFwiZXJyb3JcIjpcclxuICAgICAgICAgICAgICAgICAgICBkYXRhU3RhdHVzID0gXCJlcnJvclwiO1xyXG4gICAgICAgICAgICAgICAgICAgIHN0YXR1c01zZyA9IGRhdGEucmVhc29uO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgY2FzZSBcInByb2dyZXNzXCI6XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YVN0YXR1cyA9IFwicHJvZ3Jlc3NcIjtcclxuICAgICAgICAgICAgICAgICAgICBzdGF0dXNNc2cgPSBg0JTQsNC90L3Ri9C1INC+0LHRgNCw0LHQsNGC0YvQstCw0Y7RgtGB0Y8uINCf0L7QstGC0L7RgCDRh9C10YDQtdC3ICR7ZGF0YS50aW1lb3V0fSDRgdC10LrRg9C90LQhYDtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgZGF0YVN0YXR1cyA9IFwiZXJyb3JcIjtcclxuICAgICAgICAgICAgICAgICAgICBzdGF0dXNNc2cgPSAn0J7RiNC40LHQutCwINGB0YLRgNGD0LrRgtGD0YDRiyDQtNCw0L3QvdGL0YUhINCe0LHRgNCw0YLQuNGC0LXRgdGMINC6INGB0LjRgdGC0LXQvNC90L7QvNGDINCw0LTQvNC40L3QuNGB0YLRgNCw0YLQvtGA0YMhJztcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgc2hvd01lc3NhZ2UoZGF0YVN0YXR1cywgc3RhdHVzTXNnKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBsZXQgZ2V0U2VydmljZSA9IChjb3VudCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBqc29uRmlsZW5hbWUgPSBbXCJlcnJvci5qc29uXCIsIFwicHJvZ3Jlc3MuanNvblwiLCBcInN1Y2Nlc3MuanNvblwiXTtcclxuICAgICAgICAgICAgY29uc3QgaWRGb3JtID0gJChcIiNcIiArIHRoaXMuZm9ybUN1cnJlbnQuaWQpO1xyXG4gICAgICAgICAgICBsZXQgYWN0aW9uVXJsID0gaWRGb3JtLmF0dHIoJ2FjdGlvbicpICsganNvbkZpbGVuYW1lW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGpzb25GaWxlbmFtZS5sZW5ndGgpXTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiAkLmFqYXgoe1xyXG4gICAgICAgICAgICAgICAgdXJsOiBhY3Rpb25VcmwsXHJcbiAgICAgICAgICAgICAgICB0eXBlOiAnZ2V0JyxcclxuICAgICAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbicsXHJcbiAgICAgICAgICAgICAgICBkYXRhOiBpZEZvcm0uc2VyaWFsaXplKClcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5kb25lKChkYXRhKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoTWVzc2FnZShkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT09IFwicHJvZ3Jlc3NcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKytjb3VudCA8PSBtYXhDb3VudCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiBnZXRTZXJ2aWNlKGNvdW50KSwgcGFyc2VJbnQoZGF0YS50aW1lb3V0KSAqIDEwMDApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJChcIiNzdWJtaXRCdXR0b25cIikucmVtb3ZlQ2xhc3MoJ3B1cmUtYnV0dG9uLWRpc2FibGVkJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5mYWlsKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBzaG93TWVzc2FnZShcImVycm9yXCIsIFwi0J7RiNC40LHQutCwINC/0L7Qu9GD0YfQtdC90LjRjyDQtNCw0L3QvdGL0YUhXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICQoXCIjc3VibWl0QnV0dG9uXCIpLnJlbW92ZUNsYXNzKCdwdXJlLWJ1dHRvbi1kaXNhYmxlZCcpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLmZvcm1DdXJyZW50ID09PSBcInVuZGVmaW5lZFwiKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCByZXN1bHRWYWxpZGF0ZSA9IHRoaXMudmFsaWRhdGUoKTtcclxuICAgICAgICBjb25zdCBtYXhDb3VudCA9IDc7XHJcbiAgICAgICAgbGV0IGNvdW50ID0gMTtcclxuXHJcbiAgICAgICAgaWYgKHJlc3VsdFZhbGlkYXRlLmlzVmFsaWQpIHtcclxuICAgICAgICAgICAgJChcIiNzdWJtaXRCdXR0b25cIikuYWRkQ2xhc3MoJ3B1cmUtYnV0dG9uLWRpc2FibGVkJyk7XHJcbiAgICAgICAgICAgIGdldFNlcnZpY2UoY291bnQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuJChmdW5jdGlvbiAoKSB7XHJcbiAgICAkKCcjcmVzdWx0Q29udGFpbmVyJykuaGlkZSgpO1xyXG5cclxuICAgIHdpbmRvdy5NeUZvcm0gPSBuZXcgTG9naW5Gb3JtKFwiZm9ybS12YWxpZFwiKTtcclxuICAgIC8vIGNvbnNvbGUubG9nKE15Rm9ybS5nZXREYXRhKCkpO1xyXG5cclxuICAgIGxldCBpbml0T2JqID0ge1xyXG4gICAgICAgIGZpbzogJ9Cf0LXRgtGA0L7QsiDQmNCy0LDQvSDQktCw0YHQuNC70YzQtdCy0LjRhycsXHJcbiAgICAgICAgZW1haWw6ICdwZXRyQHlhLnJ1JyxcclxuICAgICAgICBwaG9uZTogJys3KDExMSkyMjItMzMtMTEnLFxyXG4gICAgICAgIHF3ZTogJzExMSdcclxuICAgIH07XHJcbiAgICBNeUZvcm0uc2V0RGF0YShpbml0T2JqKTtcclxuICAgIC8vIGNvbnNvbGUubG9nKE15Rm9ybS5nZXREYXRhKCkpO1xyXG5cclxuICAgICQoJyNzdWJtaXRCdXR0b24nKS5jbGljaygoZSkgPT4ge1xyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICBNeUZvcm0uc3VibWl0KCk7XHJcbiAgICB9KVxyXG59KTtcclxuIl19
